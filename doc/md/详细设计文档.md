# 灯具公司进销存系统（ISLC）软件详细设计描述文档
# V1.2 正式版
## 软件学院Debug小组

## 更新历史

修改人员 | 日期 | 变更原因 | 版本号 |
---|---|---|---|
杨袁瑞 | 2017-10-29 | 最初草稿 | V1.0 草稿
杨袁瑞 | 2017-10-30 | 整合库存管理人员，进货销售人员，财务人员，总经理的部分 | V1.1草稿
全体成员 | 2017-10-31 | 评审 | V1.2 正式版
杨袁瑞 | 2017-11-07 | 整合4个人员的展示层和数据层 | V2.0 正式版
杨袁瑞 | 2017-11-14 | 加入了BankAccountBL，ReciptBL，AccountBL模块提供给同层的接口，和需要的同层的接口
王一力 | 2017-11-14 | 加入了RecordBL，PromotionBL，CheckBL模块提供给同层的接口，和需要的同层的接口
周益冰 | 2017-11-14 | 加入了CommodityBL块提供给同层的接口，和需要的同层的接口
周正伟 | 2017-11-14 | 加入了CustomerBL,ManifestBL模块提供给同层的接口，和需要的同层的接口

## 文档目录

<html>
<ol>
    <li>引言 </li>
        1.1 编制目的<br>
        1.2 词汇表<br>
        1.3 参考资料<br>
    <li>产品概述</li>
    <li>体系结构设计概述</li>
    <li>结构视角</li>
        4.1 展示层的分解<br>
        4.2 业务逻辑层的分解<br>
        4.3 数据层的分解<br>
    <li>依赖视角</li>
</ol>
</html>


## 1. 引言
### 1.1 编制目的
本报告详细完成对灯具公司进销存系统的详细设计，达到指导详细设计和开发的目的，同时实现测试人员及用户的沟通。

本报告面向开发人员、测试人员及最终用户编写，是了解系统的导航。

### 1.2 词汇表
词汇名称 | 词汇含义 | 备注
---|---|---
ISLC | 灯具公司进销存系统 |
stockManager | 库存管理人员 |
salesMan | 进货销售人员 |
financialStaff | 财务人员 |
manager | 总经理 |
commodity | 库存 |
customer | 客户 |
administer | 管理员 |
manifest | 货单 | 包括进货单，进货退货单，销售单，销售退货单
bankAccount | 账户 | 公司的银行账户
recipt | 账单 | 包括收款单，付款单，现金费用单
record | 销售与经营记录 | 包括销售明细表，经营历程表，经营情况表
account | 账 | 整套账
check | 审批单据 |
promotion | 销售策略 |
signUp | 注册 |
login | 登录 |
UI | 界面 |
BL | 逻辑 |
Data | 数据 |
VO | value object |
PO | persistent object |

### 1.3 参考资料
1. 灯具公司进销存系统用例文档 V2.0
2. 灯具公司进销存系统需求规格说明文档 V2.0
3. 灯具公司进销存系统体系结构设计描述文档 V2.0
3. 丁二玉，刘钦.计算与软件工程（卷二）[M]机械工业出版2012：134—182
4. IEEE std 1471-2000

## 2. 产品概述
参考《灯具公司进销存系统用例文档》和《灯具公司进销存系统需求规格说明文档》中对产品的描述。

## 3. 体系结构设计概述
参考《灯具公司进销存系统体系结构设计文档中对体系结构设计的概述。

主要采用分层的架构方式，采用分布式的部署方式。

## 4. 结构视角

### 4.1 展示层的分解

##### StockManagerUI模块

类名|功能
---|---
StockManagerUI.StockManagerHomeFrame | 库存管理人员的主界面，负责导航和发起库存管理人员的界面的跳转
StockManagerUI.GoodsManageFrame | 界面frame，负责商品管理界面的显示和跳转
StockManagerUI.CatagoryManageFrame | 界面frame，负责分类管理界面的显示和跳转
StockManagerUI.CommodityFrame|界面frame，负责库存相关操作界面的显示和跳转
StockManagerUI.CommodityUI.ViewCommodityFrame|界面frame，负责库存查看界面的显示和跳转
StockManagerUI.CommodityUI.CheckCommodityFrame|界面frame，负责库存盘点界面的显示和跳转
StockManagerUI.CommodityUI.GiftListFrame|界面frame，负责商品赠送单界面的显示和跳转
StockManagerUI.CommodityUI.OverflowListFrame|界面frame，负责商品报溢单界面的显示和跳转
StockManagerUI.CommodityUI.DamageListFrame|界面frame，负责商品报损单界面的显示和跳转
StockManagerUI.CommodityUI.WarningListFrame|界面frame，负责商品报警单界面的显示和跳转
StockManagerUI.GoodsManageDetail.GoodsAddFrame|界面frame，负责新增商品时信息填写
StockManagerUI.GoodsManageDetail.GoodsModifyFrame|界面frame，负责修改商品时修改信息填写

-----------------

##### SalesmanUI模块

类名 | 功能
---|---
SalesmanUI.SalesmanHomeFrame|进货销售人员主界面的显示和界面的跳转
SalesmanUI.CustomerManageFrame|客户管理界面
SalesmanUI.ManifestFrame|制定货单选择界面
SalesmanUI.ManifestUI.GoodsInFrame|新建进货单界面
SalesmanUI.ManifestUI.GoodsInReturnFrame|新建进货退货单界面
SalesmanUI.ManifestUI.GoodsSaleFrame|新建销售单界面
SalesmanUI.ManifestUI.GoodsSaleReturnFrame|新建销售退货单界面
SalesmanUI.CustomerUI.CustomerAddFrame|新增客户信息填写界面
SalesmanUI.CustomerUI.CustomerdetailifoFrame|查看客户信息界面
SalesmanUI.CustomerUI.CustomerModifyFrame|修改客户信息界面
SalesmanUI.CustomerUI.SearchFrame|查找客户界面
SalesmanUI.CustomerUI.SearchResultFrame|查找客户界面

---------------

##### FinancialStaffUI模块

类名 | 功能
---|---
HomeFrame | 财务人员主界面的显示和负责界面跳转
BankAccountFrame | 银行账户管理界面
ReciptUI.CollectionOrderFrame | 制定收款单界面
ReciptUI.PaymentOrderFrame | 指定付款单界面
ReciptUI.CashBillFrame | 制定现金费用单界面
RecordUI.RecordFrame | 经营情况表单查看界面
RecordUI.SaleDetailFrame | 销售明细表查看界面
RecordUI.SaleHistoryFrame | 经营历程表查看界面
RecordUI.SaleStateFrame | 经营情况表的查看界面
AccountFrame | 查看期初信息、期初建账界面


--------------

##### ManagerUI模块

类名 | 功能
---|---
HomeFrame|总经理主界面的显示和界面的跳转
RecordUI.RecordFrame|经营情况表单查看界面
RecordUI.SaleDetailFrame|销售明细表查看界面
RecordUI.SaleHistoryFrame|经营历程表查看界面
RecordUI.SaleStateFrame|经营情况表的查看界面
PromotionUI.PromotionFrame|总经理促销策略制定的界面
PromotionUI.GiftPromotionFrame|总经理制定赠品促销策略界面
PromotionUI.TotalPromotionFrame|总经理制定总额特价促销策略界面
PromotionUI.TotalGiftPromotionFrame|总经理制定总额赠送促销策略界面
PromotionUI.CouponPromotionFrame|总经理制定代金券促销策略界面
CheckUI.CheckFrame|总经理审批单据界面

---------------



### 4.2 业务逻辑层的分解

#### 4.2.1  CommodityBL模块
#### 4.2.1.1 模块概述
CommodityBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。
CommodityBL模块的职责及接口参见软件系统结构描述文档。
#### 4.2.1.2 整体结构
根据体系结构的设计，采用分层风格，将系统分为展示层，业务逻辑层，数据层。每一层之间为了灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加了BussinessLogicService.CommodityBLService.CommodityBLService接口。业务逻辑层和数据层之间添加DataService.CommodityDataService.CommodityDataService接口，为了隔离业务逻辑职责和逻辑控制职责，我们添加了CommodityBLController，这样CommodityBLController会将对客户管理的逻辑处理交给Goods、Goodscatagory、CommodityRecipts、CommodityRecord对象。GoodsPO、GoodscatagoryPO、CommodityReciptsPO、CommodityRecordPO是作为商品、商品分类、库存单据、库存记录的持久化对象被添加到设计模型中去的。GoodsList、GoodsItem、CommodityRecordList、CommodityRecordItem是容器类。

##### CommodityBL模块设计图

![图：CommodityBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CommodityBL模块设计.png)


##### CommodityBL模块各个类的职责

模块|职责
---|---
CommodityBLController|负责实现商品管理界面、分类管理界面、库存管理界面、库存类单据界面所需要的服务
GoodsBL|商品管理的领域模型对象，拥有商品信息，可以帮助完成商品管理界面所需要的服务
GoodsCatagoryBL|商品分类管理的领域模型对象，拥有分类信息，可以帮助完成分类管理界面所需要的服务
CommodityBL|库存查看和库存盘点的领域模型对象，拥有库存变动记录，可以帮助完成库存管理界面所需要的服务
CommodityReciptBL|库存类单据的领域模型对象，可以帮助完成库存单据类界面所需要的服务

#### 4.2.1.3 模块内部类的接口规范
##### CommodityController的接口规范
<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.goodsAdd</th>
          <td>语法</td>
          <td>public void goodsAdd(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个Goods领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Goods领域对象的goodsAdd方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.goodsDelete</th>
          <td>语法</td>
          <td>public void goodsDelete(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个Goods领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Goods领域对象的goodsDelete方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.goodsModify</th>
          <td>语法</td>
          <td>public void goodsModify(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个Goods领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Goods领域对象的goodsModify方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.goodsFind</th>
          <td>语法</td>
          <td>public iterator<goodsVo> goodsFind(String keyWord)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个Goods领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Goods领域对象的goodsFind方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.catagoryAdd</th>
          <td>语法</td>
          <td>public void catagoryAdd(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个GoodsCatagory领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用GoodsCatagory领域对象的catagoryAdd方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.catagoryDelete</th>
          <td>语法</td>
          <td>public void catagoryDelete(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个GoodsCatagory领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用GoodsCatagory领域对象的catagoryDelete方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.catagoryModify</th>
          <td>语法</td>
          <td>public void catagoryModify(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个GoodsCatagory领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用GoodsCatagory领域对象的catagoryModify方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.ViewCommodity</th>
          <td>语法</td>
          <td>public iterator<recordsVO> viewCommodity(String period)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecord领域对象，时间段正确输入且合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecord领域对象的viewCommodity方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.CheckCommodity</th>
          <td>语法</td>
          <td>public iterator<recordsVO> checkCommodity(String date)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecord领域对象</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecord领域对象的checkCommodity方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.setGiftLIst</th>
          <td>语法</td>
          <td>public void setGiftList(giftListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecipt领域对象，库存赠送单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecipt领域对象的setGiftLIst方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.setOverflowList</th>
          <td>语法</td>
          <td>public void setOverflowList(overflowListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecipt领域对象，库存报溢单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecipt领域对象的setOverflowList方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.setDamageList</th>
          <td>语法</td>
          <td>public void setDamageList(damageListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecipt领域对象，库存报损单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecipt领域对象的setDamageList方法</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityController.setWarningList</th>
          <td>语法</td>
          <td>public void setWarningList(warningListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已创建一个CommodityRecipt领域对象，库存报警单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用CommodityRecipt领域对象的setWarningList方法</td>
        </tr>
    </table>
</html>

需要的服务（需接口）

服务名|服务
---|---
Commodity.Goods.Add|加入一个商品对象
Commodity.Goods.delete|删除一个商品对象
Commodity.Goods.modify|修改一个商品对象
Commodity.Goods.find|查找符合要求的商品对象
Commodity.GoodsCatagory.add|加入一个商品分类对象
Commodity.GoodsCatagory.delete|删除一个商品分类对象
Commodity.GoodsCatagory.modify|修改一个商品分类对象
Commodity.CommodityBL.ViewCommodity|查找符合时间要求的记录
Commodity.CommodityBL.checkCommodity|查找当天的库存变动记录
Commodity.CommodityRecipt.setGiftLIst|加入一个赠送单对象
Commodity.CommodityRecipt.setDamageList|加入一个报损单对象
Commodity.CommodityRecipt.setWarningList|加入一个报警单对象
Commodity.CommodityRecipt.setOverflowList|加入一个报溢单对象

##### Commodity的接口规范
<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.Goods.Add</th>
          <td>语法</td>
          <td>public ResultMessage goodsAdd(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>保存新增商品信息</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.Goods.Delete</th>
          <td>语法</td>
          <td>public ResultMessage goodsDelete(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除所选商品信息</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.Goods.Modify</th>
          <td>语法</td>
          <td>public ResultMessage goodsModify(goodsVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改商品信息</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.Goods.Find</th>
          <td>语法</td>
          <td>public ArrayList<GoodsVO> goodsFind(String keyWord)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回与关键字匹配的商品列表</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.GoodsCatagory.Add</th>
          <td>语法</td>
          <td>public ResultMessage catagoryAdd(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>保存新增分类信息</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.GoodsCatagory.Delete</th>
          <td>语法</td>
          <td>public ResultMessage catagoryDelete(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除所选分类信息</td>
        </tr>
        <tr>
          <th rowspan="3">Commodity.GoodsCatagory.Modify</th>
          <td>语法</td>
          <td>public ResultMessage catagoryModify(catagoryVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改分类信息</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityBL.ViewCommodity</th>
          <td>语法</td>
          <td>public CommodityInfoVO viewCommodity(String period) throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>时间段正确输入且合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统获取库存变动信息并返回</td>
        </tr>
           <th rowspan="3">CommodityRecipt.setGiftLIst</th>
          <td>语法</td>
          <td>public resultMessage setGiftList(giftListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>库存赠送单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统保存单据信息并改动库存信息</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityRecipt.setOverflowList</th>
          <td>语法</td>
          <td>public ResultMessage setOverflowList(overflowListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>库存报溢单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统保存单据信息并改动库存信息</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityRecipt.setDamageList</th>
          <td>语法</td>
          <td>public ResultMessage setDamageList(damageListVo vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>库存报损单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统保存单据信息并改动库存信息</td>
        </tr>
        <tr>
        <th rowspan="3">CommodityRecipt.setWarningList</th>
          <td>语法</td>
          <td>public ResultMessage setWarningList(warningListVo vo)</td>
        </tr>
       <tr>
          <td>前置条件</td>
          <td>库存报警单信息符合规则</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统保存单据信息并改动库存信息</td>
        </tr>
        <tr>
        <th rowspan="3">Commodity.Goods.getNextGoodsId</th>
          <td>语法</td>
          <td>public String getNextGoodsId(String category) </td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回下一个商品id</td>
        </tr>
          <th rowspan="3">Commodity.Goods.couldBeDeleted</th>
          <td>语法</td>
          <td>public boolean couldBeDeleted(String goodID)  </td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回商品是否能被删除</td>
        </tr>
        <th rowspan="3">CommodityRecipt.checkCommodityInfoToExcel</th>
          <td>语法</td>
          <td>public ResultMessage checkCommodityInfoToExcel(String fileName, String storeAdress)</td>
        </tr>
       <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>导出excel</td>
        </tr>
    </table>
</html>

需要的服务（需接口）

服务名|服务
---|---
CommodityData.Goods.add|在数据库中插入一个goodsPO对象
CommodityData.Goods.delete|在数据库中山删除一个goodsPO对象
CommodityData.Goods.modify|在数据库中山修改一个goodsPO对象
CommodityData.Goods.find|在数据库中山查找一个goodsPO对象并返回
CommodityData.Catagory.add|在数据库中山插入一个catagoryPO对象
CommodityData.Catagory.delete|在数据库中山删除一个catagoryPO对象
CommodityData.Catagory.modify|在数据库中山修改一个catagoryPO对象
CommodityData.Commdity.find|在数据库查找符合时间要求的recordsPO对象并返回
CommodityData.CommdityRecipts.add|在数据库中山插入一个reciptsPO对象
MinefistInfo.getMinefistList|返回已被审批的货单信息

#### 4.2.1.4 业务逻辑层的动态模型
下图分别表明了库存管理人员进行商品管理、商品分类管理、库存查看和库存盘点、库存类单据填写时，业务逻辑处理的相关对象之间的协作。

##### 商品管理顺序图
![图：商品管理顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/商品管理顺序图.png)

##### 分类管理顺序图
![图：分类管理顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/分类管理顺序图.png)

##### 库存查看和盘点顺序图
![图：库存查看和盘点顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/库存查看和盘点顺序图.png)

##### 库存单据顺序图
![图：库存单据顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/库存单据顺序图.png)

#### 4.2.1.5 业务逻辑层的设计原理
利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象

----------

#### 4.2.2 CustomerBL模块

#### 4.2.2.1模块概述

CustomerBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

CustomerBL模块的职责及接口参见软件系统结构描述文档。

#### 4.2.2.2整体结构

根据体系结构的设计，采用分层风格，将系统分为展示层，业务逻辑层，数据层。每一层之间为了灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加了BussinessLogicService.CustomerBLService.CustomerBLService接口。业务逻辑层和数据层之间添加DataService.CustomerDataService.CustomerDataService接口，为le隔离业务逻辑职责和逻辑控制职责，我们添加了CustomerBLController，这样CustomerBLController会将对客户管理的逻辑处理交给CustomerBL对象。CustomerPO是作为客户信息的持久化对象被添加到设计模型中去的CustomerLineItem保有应收应付等客户数据，依赖于ManifestInfo和ReciptInfo接口。

##### CustomerBL模块各个类设计图

![图：CustomerBL模块各个类设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CustomerBL模块设计.png)

#### 4.2.2.3模块内部类的接口规范

##### CustomerBLController的接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerControllerBL.customeradd</th>
          <td>语法</td>
          <td>public ResultMessage customeradd(customerVo  vo )
          </td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择新增客户</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Customer领域对象的CustomerAdd方法</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerControllerBL.customerdelete</th>
          <td>语法</td>
          <td>public ResultMessage customerdelete(customerVo  vo )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>调用Customer领域对象的CustomerDelete方法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除客户信息</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerControllerBL.customermodify</th>
          <td>语法</td>
          <td>public ResultMessage customermodify(customerVo  vo , string id )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择修改客户信息并输入客户关键字</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Customer领域对象的CustomerModify方法</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerControllerBL.customerfind</th>
          <td>语法</td>
          <td>public ArrayList<CustomerVO> customerFind(String keyword, String type )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择查询客户并输入客户关键字</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用Customer领域对象的CustomerFind方法</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>CustomerBL.customeradd(customerVO vo )</td>
            <td colspan="2">逻辑层发起添加客户任务</td>
        </tr>
        <tr>
            <td>CustomerBL.customerdelete(customerVO vo )</td>
            <td colspan="2">逻辑层发起删除客户任务</td>
        </tr>
        <tr>
            <td>CustomerBL.customermodify(customerVO vo)</td>
            <td colspan="2">逻辑层发起修改客户任务</td>
        </tr>
        <tr>
            <td>CustomerBL.customerfind(String keyword, String type )</td>
            <td colspan="2">逻辑层发起查询客户任务</td>
        </tr>
    </table>
</html>

##### CustomerBL的接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerBL.customeradd</th>
          <td>语法</td>
          <td>public ResultMessage customeradd(customerVo  vo )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择新增客户</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>保存新增客户信息</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerBL.customerdelete</th>
          <td>语法</td>
          <td>public ResultMessage customerdelete(customerVo  vo )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择删除客户</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除客户信息</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerBL.customermodify</th>
          <td>语法</td>
          <td>public ResultMessage customermodify(customerVo  vo , string id )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择修改客户信息并输入客户关键字</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>保存修改后客户信息</td>
        </tr>
        <tr>
          <th rowspan="3">CustomerBL.customerfind</th>
          <td>语法</td>
          <td>public ArrayList<CustomerVO> customerfind(string id )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货销售人员选择查询客户并输入客户关键字</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统显示符合关键字的客户列表</td>
        </tr>
        <tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>CustomerDataService.customeradd(customerVO vo )</td>
            <td colspan="2">向数据库中添加一个customerPO对象</td>
        </tr>
        <tr>
            <td>CustomerDataService.customerdelete(customerVO vo )</td>
            <td colspan="2">向数据库中删除一个customerPO对象</td>
        </tr>
        <tr>
            <td>CustomerDataService.customermodify(customerVO vo ，string id)</td>
            <td colspan="2">在数据库中查找一个customerPO对象修改后再返回</td>
        </tr>
        <tr>
            <td>CustomerDataService.customerfind(string id)</td>
            <td colspan="2">在数据库中查找一个customerPO对象再返回</td>
        </tr>
        <tr>
            <td>CommodityInfo.getGoodsList</td>
            <td colspan="2">得到商品信息列表</td>
        </tr>      
        <tr>
            <td>ReciptService.getRecipt（string condition）</td>
            <td colspan="2">得到收付款单应收应付信息</td>
        </tr>
        <tr>
            <td>ManifestService.getManifestreceive(string condition)</td>
            <td colspan="2">得到进货销售单应收应付信息</td>
        </tr>
    </table>
</html>

#### 4.2.2.4 业务逻辑层的动态模型

下图分别表明了当进货销售人员分别选择了新增，删除，修改，查询客户操作后，业务逻辑处理的相关对象之间的协作。

##### 添加客户顺序图

![图：添加客户的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CustomerAdd顺序图.png)

##### 删除客户顺序图

![图：删除客户的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CustomerDelete顺序图.png)

##### 修改客户顺序图

![图：修改客户的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CustomerModify顺序图.png)

##### 查询客户顺序图

![图：查询客户的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/CustomerFind顺序图.png)


#### 4.2.2.5业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。

---------

#### 4.2.3   ManifestBL模块
#### 4.2.3.1模块概述
ManifestBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。
ManifestBL模块的职责及接口参见软件系统结构描述文档。
#### 4.2.3.2整体结构
根据体系结构的设计，采用分层风格，将系统分为展示层，业务逻辑层，数据层。每一层之间为了灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加BussinessLogicService.ManifestBLService.ManifestBLService接口。业务逻辑层和数据层之间添加DataService.ManifestDataService.ManifestDataService接口，为了隔离业务逻辑职责和逻辑控制职责，我们添加了ManifestBLController，这样ManifestBLController会将对新增货单的逻辑处理交给ManifestBL对象。GoodsInListPO，GoodsInReturnListPO，GoodsSaleListPO，GoodsSaleReturnListPO，是作为货单信息的持久化对象被添加到设计模型中去的ManifestLineItem保有商品信息折扣等数据，依赖于CommodityReciptInfo和PromotionInfo接口。

##### ManifestBL模块各个类设计图
![图：ManifestBL模块各个类设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/ManifestBL模块设计.png)

#### 4.2.3.3模块内部类的接口规范

#### manifestBLController模块的接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBLController.setGoodsInList</th>
          <td>语法</td>
          <td>public ResultMessage setGoodsInList(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用ManifestBL领域对象的setGoodsInList方法</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBLController.setGoodsInReturnList</th>
          <td>语法</td>
          <td>public ResultMessage setGoodsInReturnList(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货退货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用ManifestBL领域对象的setGoodsInReturnList方法</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBLController.setSaleList</th>
          <td>语法</td>
          <td>public ResultMessage setSaleList(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>销售单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用ManifestBL领域对象的setGoodsSaleList方法</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBLController.setSaleReturnList</th>
          <td>语法</td>
          <td>public ResultMessage setSaleReturnList(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>销售退货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>调用ManifestBL领域对象的setGoodsSaleReturnList方法</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.deleteManifest()</th>
          <td>语法</td>
          <td>public ResultMessage deleteManifest(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除po</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.getAllCustomerName</th>
          <td>语法</td>
          <td>public ArrayList<CustomerVO> getAllCustomerName(String type)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>得到了类型</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回name</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.modifyManifest</th>
          <td>语法</td>
          <td>public ResultMessage modifyManifest(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>得到了vo</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改vo</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>ManifestBL.setGoodsInList(ManifestVO vo)</td>
            <td colspan="2">逻辑层发起新建进货单请求</td>
        </tr>
        <tr>
            <td>ManifestBL.setGoodsInReturnList(ManifestVO vo)</td>
            <td colspan="2">逻辑层发起新建进货退货单请求</td>
        </tr>
        <tr>
            <td>ManifestBL.setSaleList(ManifestVO vo)</td>
            <td colspan="2">逻辑层发起新建销售单请求</td>
        </tr>
        <tr>
            <td>ManifestBL.setSaleReturnList(ManifestVO vo)</td>
            <td colspan="2">逻辑层发起新建销售退货单请求</td>
        </tr>
    </table>
</html>

#### manifestBL模块的接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBL.setGoodsInList</th>
          <td>语法</td>
          <td>public ResultMessage setGoodsInList(Manifest vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统将单据提交给总经理审批</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBL.setGoodsInReturnList</th>
          <td>语法</td>
          <td>public ResultMessage setGoodsInReturnList(Manifest vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>进货退货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统将单据提交给总经理审批</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBL.setSaleList</th>
          <td>语法</td>
          <td>public ResultMessage setSaleList(Manifest vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>销售单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统将单据提交给总经理审批</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestBL.setSaleReturnList</th>
          <td>语法</td>
          <td>public ResultMessage setSaleReturnList(Manifest vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>销售退货单填写规格正确</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统将单据提交给总经理审批</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.deleteManifest()</th>
          <td>语法</td>
          <td>public ResultMessage deleteManifest(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除po</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.getAllCustomerName</th>
          <td>语法</td>
          <td>public ArrayList<CustomerVO> getAllCustomerName(String type)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>得到了类型</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回name</td>
        </tr>
        <tr>
          <th rowspan="3">ManifestService.modifyManifest</th>
          <td>语法</td>
          <td>public ResultMessage modifyManifest(ManifestVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>得到了vo</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改vo</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>ManifestDataService.setGoodsInList(Manifest vo)</td>
            <td colspan="2">向数据库中添加一个GoodsInListPO对象</td>
        </tr>
        <tr>
            <td>ManifestDataService.setGoodsInReturnList(Manifest vo)</td>
            <td colspan="2">向数据库中添加一个GoodsInReturnListPO对象</td>
        </tr>
        <tr>
            <td>ManifestDataService.setSaleList(Manifest vo)</td>
            <td colspan="2">向数据库中添加一个SaleListPO对象</td>
        </tr>
        <tr>
            <td>ManifestDataService.setSaleReturnList(Manifest vo)</td>
            <td colspan="2">向数据库中添加一个SaleReturnListPO对象</td>
        </tr>
        <tr>
            <td>CommodityInfo.getGoodsList</td>
            <td colspan="2">得到商品信息列表</td>
        </tr>
        <tr>
            <td>PromotionInfo.getPromotion</td>
            <td colspan="2">得到优惠信息</td>
        </tr>
    </table>
</html>

#### 4.2.3.4 业务逻辑层的动态模型

下图表明了当进货销售人员分别选择了新增进货，进货退货，销售，销售退货单据操作后，业务逻辑处理的相关对象之间的协作。

##### 新建进货单顺序图

![图：新建进货单的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/Manifest进货单顺序图.png)

##### 新建进货退货单顺序图

![图：新建进货退货单的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/Manifest进货退货单顺序图.png)

##### 新建销售单顺序图

![图：新建销售单的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/Manifest销售单顺序图.png)

##### 新建销售退货单顺序图

![图：新建销售退货单的顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/Manifest销售退货单顺序图.png)


#### 4.2.2.5业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。

--------------

### 4.2.4 BankAccountBL模块

#### 4.2.4.1 模块概述

BankAccountBL模块承担的需求参见需求规格说明文档功能需求及非功能需求。

BankAccountBL模块的职责及接口参见软件体系结构设计文档5.3.2.4。

#### 4.2.4.2 整体结构

为了隔离业务逻辑职责和逻辑控制职责，我们增加了BankAccountBLController，这样BankAccountBLController会将对银行账户管理的业务逻辑委托给BankAccountBL对象。

BankAccountPO是作为银行账户的持久化对象被添加到设计模型中去的。BankAccountInfo是根据依赖倒置原则产生的接口。


**BankAccountBL模块的设计如下图所示。**

图： BankAccountBL模块的个各类的设计

![图：BankAccountBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/BankAccountBL模块设计.png)


**BankAccountBL模块各个类的职责如下表。**

模块 | 职责
---|---
BankAccountBLController | 负责实现银行账户管理界面所需要的服务
User | 系统用户的领域模型对象，拥有用户数据的用户名、密码、权限，可以根据权限访问某些功能。
BankAccountBL | 银行账户管理的领域模型对象，拥有银行账户列表。


#### 4.2.4.3 模块内部类的接口规范

##### BankAccountBLController的接口规范

<html>
<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBLController.add</th>
        <td>语法</td>
        <td>public ResultMessage add (BankAccountVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BankAccountBL领域对象，已输入新用户的名称和金额，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BankAccountBL领域对象的add方法</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBLController.delete</th>
        <td>语法</td>
        <td>public ResultMessage delete (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BankAccountBL领域对象，并且得到了要删除用户的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BankAccountBL领域对象的delete方法</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBLController.modify</th>
        <td>语法</td>
        <td>public ResultMessage modify (BankAccountVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BankAccountBL领域对象，得到了已经修改好的新的用户信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BankAccountBL领域对象的modify方法</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBLController.find</th>
        <td>语法</td>
        <td>public BankAccountVO find (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BankAccountBL领域对象，得到了将要查询的用户的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BankAccountBL领域对象的find方法</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>BankAccountBL.add (BankAccountVO vo)</td>
        <td colspan="2">新增一个银行账户对象</td>
    </tr>
    <tr>
        <td>BankAccountBL.delete (String id)</td>
        <td colspan="2">删除一个银行账户对象</td>
    </tr>
    <tr>
        <td>BankAccountBL.modify (BankAccountPO po)</td>
        <td colspan="2">修改一个银行账户对象的属性</td>
    </tr>
    <tr>
        <td>BankAccountBL.find (String id)</td>
        <td colspan="2">查找一个对应id的银行账户对象</td>
      </tr>
</table>
</html>

##### BankAccountBL的接口规范

<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBL.add</th>
        <td>语法</td>
        <td>public ResultMessage add (bankAccountVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了符合格式的新用户信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将新用户的信息保存，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBL.delete</th>
        <td>语法</td>
        <td>public ResultMessage delete (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了将要删除的用户的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该用户的信息删除，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBL.modify</th>
        <td>语法</td>
        <td>public ResultMessage modify (bankAccountVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了已经修改好的新的用户信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该用户的信息更新，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountBL.find</th>
        <td>语法</td>
        <td>public BankAccountVO find (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了将要查询的用户的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>查询该用户的信息，返回查询的结果</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountInfo.getBankAccountList</th>
        <td>语法</td>
        <td>public ArrayList<String> getBankAccountList (String condition)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了查找的条件</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>查询银行账户，返回符合条件的银行账户的id</td>
    </tr>
    <tr>
        <th rowspan="3">BankAccountInfo.getBankAccount</th>
        <td>语法</td>
        <td>public BankAccountPO getBankAccount (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了将需要的用户的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>查询银行账户，返回符合条件的银行账户</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>DatabaseFacory.getBankAccountDatabase ()</td>
        <td colspan="2">得到BankAccount数据库的服务的引用</td>
    </tr>
    <tr>
        <td>BankAccountDataService.add (BankAccountPO po)</td>
        <td colspan="2">在数据库中加入BankAccountPO对象</td>
    </tr>
    <tr>
        <td>BankAccountDataService.delete (String id)</td>
        <td colspan="2">在数据库中删除该id对应的BankAccount项</td>
    </tr>
    <tr>
        <td>BankAccountDataService.modify (BankAccountPO po)</td>
        <td colspan="2">修改数据库中对应的项</td>
    </tr>
    <tr>
        <td>BankAccountDataService.find (String id)</td>
        <td colspan="2">在数据库中查询该id对应的BankAccount项</td>
    </tr>
</table>


#### 4.2.4.4 业务逻辑层的动态模型

##### 新增银行账户顺序图

当财务人员选择了新增，新增银行账户的业务逻辑处理的相关对象之间的协作如下图所示。

![图：新增银行账户顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/新增银行账户顺序图.png)


##### 修改银行账户顺序图

当财务人员填写了修改的信息后，修改银行账户的业务逻辑处理的相关对象之间的协作如下图所示。

![图：修改银行账户顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/修改银行账户顺序图.png)

##### 删除银行账户顺序图

当财务人员选择需要删除的用户并选择删除后，删除银行账户的业务逻辑处理的相关对象之间的协作如下图所示。

![图：删除银行账户顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/删除银行账户顺序图.png)

##### 查询银行账户顺序图

当财务人员选择需要删除的用户并选择删除后，删除银行账户的业务逻辑处理的相关对象之间的协作如下图所示。

![图：查询银行账户顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/查询银行账户顺序图.png)

#### 4.2.4.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由个字的控制器委托给不同的领域对象。


-----------

### 4.2.5 ReciptBL模块

#### 4.2.5.1 模块概述

ReciptBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。
ReciptBL模块的职责及接口参见软件系统结构描述文档5.3.2.5。

#### 4.2.5.2 整体结构

为了隔离业务逻辑职责和逻辑控制职责，我们增加了ReciptBLController，这样ReciptBLController会将对销售的业务逻辑处理委托给ReciptBL对象。

ReciptPO，CollectionOrderPO，PaymentOrderPO，CashBillPO分别是作为财务单据，收款单，付款单，现金费用单的持久化对象被添加到设计模型中去的。

TransferList的添加是TransferLineItem的容器类。TransferLIneitem保有转账的信息（包括银行账户，转账金额，备注）；而TransferList封装了关于TransferLineItem的数据集合和数据结构和计算总额的职责。CashList的添加是CashLineItem的容器类。CashLIneitem保有现金条目的信息（包括条目名，金额，备注）；而CashList封装了关于CashLineItem的数据集合和数据结构和计算总额的职责。

ReciptInfo, CustomerInfo都是根据依赖倒置原则产生的接口。

**ReciptBL模块的设计如下图所示。**

![图：ReciptBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/ReciptBL模块设计.png)

**ReciptBL模块各个类的职责如下表所示。**

模块 | 职责
---|---
ReciptBLController | 负责实现财务单据界面所需要的服务
ReciptBL | 财务单据处理的领域模型对象，可以帮助完成财务单据界面所需要的服务
CollectionOrder | 收款单的领域模型对象，拥有一个收款单据所持有的信息（单据编号（SKD-yyyyMMdd-xxxxx），客户（同时包含供应商和销售商），操作员（当前登录用户），转账列表，总额汇总）
PaymentOrder | 付款单的领域模型对象，拥有一个付款单据所持有的信息（单据编号（FKD-yyyyMMdd-xxxxx），客户（同时包含供应商和销售商），操作员（当前登录用户），转账列表，总额汇总）
CashBill | 现金费用单的领域模型对象，拥有一个现金费用单所持有的信息（单据编号（XJFYD-yyyyMMdd-xxxxx）,操作员（当前登录用户），银行账户，条目清单，总额）


#### 4.2.5.3 模块内部类的接口规范

<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.setCollectionOrder</th>
        <td>语法</td>
        <td>public ResultMessage setCollectionOrder (CollectionOrderVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个ReciptBL领域对象，已填写了收款单里的信息，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的setCollectionOrder方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.setPaymentOrder</th>
        <td>语法</td>
        <td>public ResultMessage setPaymentOrder (PaymentOrderVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个ReciptBL领域对象，已填写了付款单里的信息，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的setPaymentOrder方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.setCashBill</th>
        <td>语法</td>
        <td>public ResultMessage setCashBill (CashBillVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个ReciptBL领域对象，已填写了现金费用单里的信息，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的setCashBill方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.findOne</th>
        <td>语法</td>
        <td>public ReciptVO findOne (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个ReciptBL领域对象，得到了格式正确的单据编号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用RecipitBL的findOne方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getBankAccount</th>
        <td>语法</td>
        <td>public ArrayList<BankAccountVO> getBankAccount(String part) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>返回模糊查找的银行账户</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getBankAccount方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getCustomerList</th>
        <td>语法</td>
        <td>public ArrayList<CustomerVO> getCustomerList(String keyword, String customerName) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>客户的模糊查找</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getCustomerList方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getAllRecipts</th>
        <td>语法</td>
        <td>public ArrayList<ReciptVO> getAllRecipts() throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>获得所有的单据所有的单据列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getAllRecipts的方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getAllCollectionOrderList</th>
        <td>语法</td>
        <td>public ArrayList<CollectionOrderVO> getAllCollectionOrderList() throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>获取所有的收款单列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getAllCollectionOrderList的方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getAllPaymentOrderList</th>
        <td>语法</td>
        <td>public ArrayList<PaymentOrderVO> getAllPaymentOrderList() throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>获取所有的付款单列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getAllPaymentOrderList的方法</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBLController.getAllCashBillList</th>
        <td>语法</td>
        <td>public ArrayList<CashBillVO> getAllCashBillList() throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>获取所有的现金费用单列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用ReciptBL的getAllCashBillList的方法</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>ReciptBL.setCollection(CollectionOrderVO vo)</td>
        <td colspan="2">添加一个收款单对象</td>
    </tr>
        <tr>
        <td>ReciptBL.setPaymentOrder(PaymentOrderVO vo)</td>
        <td colspan="2">添加一个付款单对象</td>
    </tr>
        <tr>
        <td>ReciptBL.setCashBill(CashBillVO vo)</td>
        <td colspan="2">添加一个现金费用单对象</td>
    </tr>
    <tr>
        <td>ReciptBL.findOne (String id)</td>
        <td colspan="2">查询对应id编号的财务单据</td>
    </tr>
    <tr>
        <td>ReciptBL.getACollectionOrder</td>
        <td colspan="2">获取一个收款单</td>
    </tr>
    <tr>
        <td>ReciptBL.getAPaymentOrder</td>
        <td colspan="2">获取一个付款单</td>
    </tr>
    <tr>
        <td>ReciptBL.getACashBill</td>
        <td colspan="2">获取一个现金费用单</td>
    </tr>
     <tr>
        <td>ReciptBL.getNextID</td>
        <td colspan="2">获取下一个id方法</td>
    </tr>
    <tr>
        <td>ReciptBL.getUncheckedCollectionOrder()</td>
        <td colspan="2">获取未审批的收款单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.saveCollectionOrder</td>
        <td colspan="2">保存收款单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.getUncheckedCashBillPO</td>
        <td colspan="2">保存未审批的现金费用单</td>
    </tr>
    <tr>
        <td>ReciptBL.saveCashBillPO</td>
        <td colspan="2">保存现金费用单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.getUncheckedPaymentOrder</td>
        <td colspan="2">获取未审批的付款单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.savePaymentOrder</td>
        <td colspan="2">保存付款单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.getCheckedReciptList</td>
        <td colspan="2">提供财务单据情况筛选</td>
    </tr>
    <tr>
        <td>ReciptBL.getCheckedCollectionOrderList</td>
        <td colspan="2">提供收款单情况筛选</td>
    </tr>
     <tr>
        <td>ReciptBL.getCheckedPaymentOrderList</td>
        <td colspan="2">提供付款单情况筛选</td>
    </tr>
    <tr>
        <td>ReciptBL.getCheckedCashBillList</td>
        <td colspan="2">提供现金费用单筛选</td>
    </tr>
     <tr>
        <td>ReciptBL.getAllCollectionOrderList</td>
        <td colspan="2">获取全部收款单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.getAllPaymentOrderList</td>
        <td colspan="2">获取全部付款单列表</td>
    </tr>
      <tr>
        <td>ReciptBL.getAllCashBillList</td>
        <td colspan="2">获取所有现金费用单列表</td>
    </tr>
    <tr>
        <td>ReciptBL.setRedDashed</td>
        <td colspan="2">设置红冲</td>
    </tr>
      <tr>
        <td>ReciptBL.getAllRecipts</td>
        <td colspan="2">获取全部的单据列表</td>
    </tr>
</table>

##### ReciptBL模块的接口规范

<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">ReciptBL.setCollectionOrder</th>
        <td>语法</td>
        <td>public ResultMessage setCollectionOrder (CollectionOrderVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了符合格式的收款单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该财务单据保存，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBL.setPaymentOrder</th>
        <td>语法</td>
        <td>public ResultMessage setPaymentOrder (PaymentOrderVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了符合格式的付款单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该财务单据保存，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBL.setCashBill</th>
        <td>语法</td>
        <td>public ResultMessage setCashBill (CashBillVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了符合格式的现金费用单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该财务单据保存，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptBL.findOne</th>
        <td>语法</td>
        <td>public ReciptVO findOne (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了财务单据的编号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>查询该编号对应单据的详细信息，并返回信息</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptService.getRecipt (String condition)</th>
        <td>语法</td>
        <td>```public ArrayList<ReciptPO> getRecipt (String condition)```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了筛选的条件</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将符合条件的Recipt返回</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptService.getUncheckedRecipt ()</th>
        <td>语法</td>
        <td>```public ArrayList<ReciptPO> getUncheckedRecipt ()```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将未被审批的Recipt返回</td>
    </tr>
    <tr>
        <th rowspan="3">ReciptService.modifyRecipt (ArrayList<ReciptPO> poList)</th>
        <td>语法</td>
        <td>```public boolean modifyRecipt (ArrayList<ReciptPO> poList)```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>修改了一些财务单据</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将这些修改的财务单据保存</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>DatabaseFacory.getReciptDatabase ()</td>
        <td colspan="2">得到Recipt数据库的服务的引用</td>
    </tr>
    <tr>
        <td>ReciptDataService.addCollectionOrder(CollectionOrderPO po)</td>
        <td colspan="2">在数据库中添加一个收款单</td>
    </tr>
        <tr>
        <td>ReciptDataService.addPaymentOrder(PaymentOrderPO po)</td>
        <td colspan="2">在数据库中添加一个付款单</td>
    </tr>
        <tr>
        <td>ReciptDataService.addCashBill(CashBillPO po)</td>
        <td colspan="2">在数据库中添加一个现金费用单</td>
    </tr>
    <tr>
        <td>ReciptDataService.getOne (String id)</td>
        <td colspan="2">在数据库中查询对应id编号的财务单据</td>
    </tr>
    <tr>
        <td>CustomerInfo.getCustomerList (String id)</td>
        <td colspan="2">获得符合条件的客户的列表</td>
    </tr>
</table>


#### 4.2.5.4 业务逻辑层的动态模型

##### 新建收款单顺序图

财务人员填写了收款单后，新建收款单的业务逻辑处理的相关对象之间的协作如下图所示。

![图：新建收款单顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/新建收款单顺序图.png)

##### 新建付款单顺序图

财务人员填写了付款单后，新建付款单的业务逻辑处理的相关对象之间的协作如下图所示。

![图：新建付款单顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/新建付款单顺序图.png)

##### 新建现金费用单顺序图

财务人员填写了现金费用单后，新建现金费用单的业务逻辑处理的相关对象之间的协作如下图所示。

![图：新建现金费用单顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/新建现金费用单顺序图.png)


#### 4.2.5.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由个字的控制器委托给不同的领域对象。


-----------

### 4.2.6 AccountBL模块

#### 4.2.6.1 模块概述

AccountBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。
AccountBL模块的职责及接口参见软件系统结构描述文档5.3.2.6。

#### 4.2.6.2 整体结构

为了隔离业务逻辑职责和逻辑控制职责，我们增加了AccountBLController，这样AccountBLController会将对账的业务逻辑委托给AccountBL对象。

AccountPO是作为账信息的持久化对象被添加到设计模型中去的。

GoodsList和GoodsLineItem的添加是GoodsInfo的容器类。GoodsLineItem保有商品的属性。GoodsList封装了关于GoodsLineItem的数据集合的数据结构。

CustomerList和CustomerLineItem的添加是CustomerInfo的容器类。CustomerLineItem保有顾客的属性。CustomerList封装了关于CustomerLineItem的数据集合的数据结构。

GoodsInfo和CustomerInfo是根据依赖倒置原则产生的接口。

**AccountBL模块的设计如下图所示**

![图：AccountBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/AccountBL模块设计.png)

**AccountBL模块各个类的职责如下表所示。**

模块 | 职责
---|---
AccountBLController | 负责实现财务单据界面所需要的服务
AcocuntBL | 财务单据处理的领域模型对象，可以帮助完成财务单据界面所需要的服务


#### 4.2.6.3 模块内部类的接口规范

##### AccountBLController模块的接口规范

<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.set</th>
        <td>语法</td>
        <td>public ResultMessage set (AccountVO vo) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，完整的填写了期初信息，并且输入符合规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的set方法</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.addGoods</th>
        <td>语法</td>
        <td>public ResultMessage addGoods (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，得到了商品的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的addGoods方法</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.getGoods</th>
        <td>语法</td>
        <td>```public ArrayList<GoodsVO> getGoods (String partID) throws RemoteException```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，得到了所需商品的部分id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的getGoods方法</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.addCustomer</th>
        <td>语法</td>
        <td>public ResultMessage addCustomer (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，得到了客户的ID</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的addCustomer方法</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.getCustomer</th>
        <td>语法</td>
        <td>```public ArrayList<CustomerVO> getCustomer (String partID) throws RemoteException```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，得到了所需客户的部分ID</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的getCustomer方法</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBLController.get</th>
        <td>语法</td>
        <td>public AccountVO get (String id) throws RemoteException</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个AccountBL领域对象，获得了所需的账的编号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用AccountBL领域对象的get方法</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>AccountBL.set(AccountVO)</td>
        <td colspan="2">加入一个Account对象</td>
    </tr>
    <tr>
        <td>AccountBL.addGoods(String id)</td>
        <td colspan="2">在商品列表中添加一个Goods对象</td>
    </tr>
    <tr>
        <td>AccountBL.getGoods(String partID)</td>
        <td colspan="2">得到一个Goods对象</td>
    </tr>
    <tr>
        <td>AccountBL.addCustomer(String id)</td>
        <td colspan="2">在客户列表中添加一个Customer对象</td>
    </tr>
    <tr>
        <td>AccountBL.getCustomer(String partID)</td>
        <td colspan="2">得到一个Customer对象</td>
    </tr>
    <tr>
        <td>AccountBL.get(String id)</td>
        <td colspan="2">得到一个账对象</td>
    </tr>
</table>


##### AccountBL模块的接口规范

<table>
    <tr>
        <th colspan="3">提供的服务（供接口）</th>
    </tr>
    <tr>
        <th rowspan="3">AccountBL.set</th>
        <td>语法</td>
        <td>public ResultMessage set (AccountVO vo)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了符合格式的期初建账信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该期初信息保存，并返回更新结果</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBL.addGoods</th>
        <td>语法</td>
        <td>public ResultMessage addGoods (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了商品的id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在商品列表中添加一个商品</td>
    <tr>
        <th rowspan="3">AccountBL.getGoods</th>
        <td>语法</td>
        <td>```public ArrayList<GoodsVO> getGoods (String partID)```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了所需商品的部分id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>搜索符合的商品，并返回</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBL.addCustomer</th>
        <td>语法</td>
        <td>public ResultMessage addCustomer (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了客户的部分ID</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在客户列表中添加一个客户</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBL.getCustomer</th>
        <td>语法</td>
        <td>```public ArrayList<CustomerVO> getCustomer (String partID)```</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>得到了所需客户的部分ID</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>搜索符合的客户，并返回</td>
    </tr>
    <tr>
        <th rowspan="3">AccountBL.get</th>
        <td>语法</td>
        <td>public AccountVO get (String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>获得了所需的账的编号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据编号查找对应的账，并返回</td>
    </tr>
    <tr>
        <th colspan="3">需要的服务（需接口）</th>
    </tr>
    <tr>
        <th>服务名</th>
        <th colspan="2">服务</th>
    </tr>
    <tr>
        <td>DatabaseFacory.getAccountDatabase ()</td>
        <td colspan="2">得到Account数据库的服务的引用</td>
    </tr>
    <tr>
        <td>AccountDataService.get(String id)</td>
        <td colspan="2">在数据库中查询对应id的账的信息</td>
    </tr>
    <tr>
        <td>CustomerInfo.getCustomerList (String id)</td>
        <td colspan="2">得到符合条件的客户的列表</td>
    </tr>
    <tr>
        <td>GoodsInfo.getGoodsList (String id)</td>
        <td colspan="2">得到符合条件的商品的列表</td>
    </tr>
</table>


#### 4.2.6.4 业务逻辑层的动态模型

##### 期初建账顺序图

财务人员填写了期初信息后，期初建账的业务逻辑处理的相关对象之间的协作如下图所示。

![图：期初建账顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/期初建账顺序图.png)

##### 期初建账添加商品顺序图

财务人员在填写期初信息时，需要添加商品，业务逻辑的相关对象之间的协作如下图所示。

![图：期初建账添加商品顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/期初建账添加商品顺序图.png)

##### 期初建账添加客户顺序图

财务人员在填写期初信息时，需要添加客户，业务逻辑的相关对象之间的协作如下图所示。

![图：期初建账添加客户顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/期初建账添加客户顺序图.png)


#### 4.2.6.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由个字的控制器委托给不同的领域对象。

-----------

#### 4.2.7 recordbl模块

##### 4.2.7.1模块概述

recordbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求<br>
recordbl模块的职责及接口参见软件系统结构描述文档表<br>

#### 4.2.7.2整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如在展示层和业务逻辑层之间，我们添加BusinessLogicService.RecordBLService接口。为了隔离业务逻辑层和逻辑控制职责，我们增加了RecordController，这样RecordController会将对销售业务逻辑处理处理委托给Record对象。RecordPO是作为经营情况记录持久化对象被添加到设计模型中去的。而RecordList和RecordItem的添加是容器类。RecordItem保有经营情况单据的数据，RecordList封装了关于RecordItem数据集合的数据结构的秘密和进行部分相关计算的职责。ManifestService和ReciptService都是根据依赖倒置原则，为了消除循环依赖而产生的接口。

##### RecordBL模块设计图

![图：RecordBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/recordbl模块设计模型图.png)

recordBL模块各个类职责如下表所示
模块|职责
---|---
RecordController|负责实现经营情况表、经营历程表、销售明细表查看界面所需要的服务
Record|经营状态查看领域的模型对象，拥有经营情况表、经营历程表、销售明细表的信息和相关计算功能，可以帮助完成经营状态查看所需要的服务
SalesDetailList|销售明细表的模型对象，持有销售明细表的相关信息
ManageHistoryList|经营历程表的模型对象，持有经营历程表的相关信息
ManageStateList|经营情况表的模型对象，持有经营情况表的相关信息


#### 4.2.7.3模块内部类的接口规范

RecordController和Record的接口规范如下表所示<br>

##### RecordController接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesDetailList</th>
          <td>语法</td>
          <td>public ArrayList<ReciptGoodsVO> getSalesDetailList(String startTime, String endTime, 
			String goodsName, String customerName, String operator) throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看销售明细表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesStateList</th>
          <td>语法</td>
          <td>public SaleStateVO getSalesStateList(String startTime, String endTime) throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看经营情况表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesHistoryList</th>
          <td>语法</td>
          <td>public InfoVO getSalesHistoryList(String startTime, String endTime, 
			DocumentsType type, String customerName, String operator)
			throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看经营历程表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>RecordBL.getSalesHistoryList(String startTime, String endTime, 
			DocumentsType type, String customerName, String operator)</td>
            <td colspan="2">查找经营历程表</td>
        </tr>
        <tr>
            <td>RecordBL.getSalesStateList(String startTime, String endTime)</td>
            <td colspan="2">查找经营情况表</td>
        </tr>
        <tr>
            <td>RecordBL.getSalesDetailList(String startTime, String endTime, 
			String goodsName, String customerName, String operator)</td>
            <td colspan="2">查找销售明细表</td>
        </tr>
    </table>
</html>

##### Record接口规范
<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesDetailList</th>
          <td>语法</td>
          <td>public ArrayList<ReciptGoodsVO> getSalesDetailList(String startTime, String endTime, 
			String goodsName, String customerName, String operator) throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看销售明细表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesStateList</th>
          <td>语法</td>
          <td>public SaleStateVO getSalesStateList(String startTime, String endTime) throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看经营情况表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
        <tr>
          <th rowspan="3">RecordControllerBL.getSalesHistoryList</th>
          <td>语法</td>
          <td>public InfoVO getSalesHistoryList(String startTime, String endTime, 
			DocumentsType type, String customerName, String operator)
			throws RemoteException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选择查看经营历程表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>查找数据并返回打包好的表格数据</td>
        </tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>DatabaseFactory.getRecordData</td>
            <td colspan="2">得到数据库服务的引用</td>
        </tr>
        <tr>
            <td>HibernateHelp.getHibernate(String id)</td>
            <td colspan="2">根据ID查找单一持久化对象</td>
        </tr>
        <tr>
            <td>RecordDataService.finds(String fields, int value)</td>
            <td colspan="2">根据字段名称和值查找多个持久化对象</td>
        </tr>
        <tr>
            <td>ManifestService.getUncheckedManifests()</td>
            <td colspan="2">获取所有货单</td>
        </tr>
        <tr>
            <td>ReciptService.getRecipts()</td>
            <td colspan="2">获取所有账单</td>
        </tr>
    </table>
</html>

#### 4.2.7.4业务逻辑层的动态模型

下图表明了灯具销售系统中，当总经理或者财务人员查看表单时，查看表单业务逻辑处理和对象之间的协作

##### 经营情况查看顺序图
![图：经营情况查看顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/经营情况查看顺序图.png)

#### 4.2.7.5业务逻辑层的设计原理
利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象

------------------

#### 4.2.8 checkbl模块

##### 4.2.8.1 模块概述

checkbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求<br>
checkbl模块的职责及接口参见软件系统结构描述文档表<br>

#### 4.2.8.2 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如在展示层和业务逻辑层之间，我们添加BusinessLogicService.CheckBLService接口。为了隔离业务逻辑层和逻辑控制职责，我们增加了CheckController，这样CheckController会将查看审批单据委托给Check对象。CheckPO是作为审批单据持久化对象被添加到设计模型中去的。而RecordList和CheckItem的添加是容器类CheckItem保有经营情况单据的数据，CheckList封装了关于CheckItem数据集合的数据结构的秘密和进行部分相关计算的职责。ManifestService和ReciptService都是根据依赖倒置原则，为了消除循环依赖而产生的接口。

##### CheckBL模块设计图
![图：CheckBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/checkbl模块设计模型图.png)

checkBL模块各个类职责如下表所示
模块|职责
---|---
CheckController|负责实现单据审批界面所需要的服务
Check|单据审批领域的模型对象，拥有审批单据的相关信息和计算功能，以及设置审批意见的功能，可以帮助完成单据审批所需要的服务
CheckItem|审批单据的模型对象，持有审批单据的相关信息

#### 4.2.8.3 模块内部类的接口规范

CheckController和Check的接口规范如下表所示<br>

##### CheckController接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CheckBL.getInfo</th>
          <td>语法</td>
          <td>private InfoVO getInfo()</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理已经登录</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">CheckBL.setSuggestion</th>
          <td>语法</td>
          <td>public ResultMessage setSuggestion(infoVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理更改待审批的单据状态</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
         <tr>
            <td>CheckBL.getInfo()</td>
            <td colspan="2">获取待审批单据的信息</td>
        </tr>
        <tr>
            <td>CheckBL.setSuggestion(infoVO vo)</td>
            <td colspan="2">更改待审批的单据状态</td>
        </tr>
    </table>
</html>

##### checkBL接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CheckBL.getInfo</th>
          <td>语法</td>
          <td>private infoVO getInfo()</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理已经登录</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">CheckBL.setSuggestion</th>
          <td>语法</td>
          <td>public void setSuggestion(infoVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理批量更改待审批单据审批状态</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>ReciptService.getCollectionOrderList</td>
            <td colspan="2">获取未审批的收款单</td>
        </tr>
        <tr>
            <td>ReciptService.getPaymentOrderList</td>
            <td colspan="2">获取未审批的付款单</td>
        </tr>
        <tr>
            <td>ReciptService.getCashBillList</td>
            <td colspan="2">获取未审批的现金费用单</td>
        </tr>
        <tr>
            <td>ManifestService.getManifestList</td>
            <td colspan="2">获取未审批的现金费用单</td>
        </tr>        
        <tr>
            <td>CommodityService.getCommodityReciptList</td>
            <td colspan="2">获取未审批的现金费用单</td>
        </tr>
        <tr>
            <td>ReciptService.saveCollectionOrderList</td>
            <td colspan="2">保存改变状态后的收款单</td>
        </tr>
        <tr>
            <td>ReciptService.savePaymentOrderList</td>
            <td colspan="2">保存改变状态后的付款单</td>
        </tr>
        <tr>
            <td>ReciptService.saveCashBillList</td>
            <td colspan="2">保存改变状态后的的现金费用单</td>
        </tr>
        <tr>
            <td>ManifestService.saveManifestList</td>
            <td colspan="2">保存改变状态后的现金费用单</td>
        </tr>        
        <tr>
            <td>CommodityService.saveCommodityReciptList</td>
            <td colspan="2">保存改变状态后的现金费用单</td>
        </tr>
    </table>
</html>

#### 4.2.8.4 业务逻辑层的动态模型

下图表明了灯具销售系统中，当总经理进行单据审批时，审批业务逻辑处理和对象之间的协作

##### 总经理单据审批顺序图
![图：总经理单据审批顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/总经理单据审批顺序图.png)

#### 4.2.8.5 业务逻辑层的设计原理
利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象

-----------------

#### 4.2.9 promotion模块

##### 4.2.9.1 模块概述

promotionbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求<br>
promotionbl模块的职责及接口参见软件系统结构描述文档表<br>

#### 4.2.9.2 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如在展示层和业务逻辑层之间，我们添加BusinessLogicService.PromotionBLService接口。为了隔离业务逻辑层和逻辑控制职责，我们增加了PromotionController，这样PromotionController会将指定销售策略委托给Promotion对象。PromotionPO是作为促销策略信息记录持久化对象被添加到设计模型中去的。而PromotionList和PromotionItem的添加是容器类PromotionItem保有促销策略的数据，PromotionList封装了关于PromotionItem数据集合的数据结构的秘密和进行部分相关计算的职责。PromotionInfo是根据依赖倒置原则，为了消除循环依赖而产生的接口。而此模块实现了这一接口。

##### PromotionBL模块设计图
![图：PromotionBL模块设计](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/promotionbl模块设计模型图.png)

promotionBL模块各个类职责如下表所示
模块|职责
---|---
PromotionController|负责实现制定促销策略界面所需要的服务
Promotion|促销策略制定领域的模型对象，拥有促销策略项目的相关信息和计算功能，可以帮助完成促销策略制定所需要的服务
PromotionItem|促销策略的模型对象，持有促销策略的相关信息

#### （3）模块内部类的接口规范

PromotionController和Promotion的接口规范如下表所示<br>

##### PromotionController接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.setPromotion</th>
          <td>语法</td>
          <td>public boolean setPromotion(promotionVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理设置促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.getPromotion</th>
          <td>语法</td>
          <td>public list<promotionVO> getPromotion()</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理获取促销策略列表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.deletePromotion</th>
          <td>语法</td>
          <td>public list<promotionVO> deletePromotion(String promotionID)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选中要删除的促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.modifyPromotion</th>
          <td>语法</td>
          <td>public boolean modifyPromotion(String promotionID, promotionVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理更改原来的促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>PromotionBL.setPromotion(promotionVO vo)</td>
            <td colspan="2">设置一个新的促销策略</td>
        </tr>
        <tr>
            <td>PromotionBL.getPromotion()</td>
            <td colspan="2">获取促销策略列表</td>
        </tr>
        <tr>
            <td>PromotionBL.deletePromotion(String promotionID)</td>
            <td colspan="2">删除已有促销策略</td>
        </tr>
        <tr>
            <td>PromotionBL.modifyPromotion(String promotionID, promotionVO vo)</td>
            <td colspan="2">修改已有促销策略</td>
        </tr>
    </table>
</html>

##### Promotion接口规范

<html>
    <table>
        <tr>
            <td colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.setPromotion</th>
          <td>语法</td>
          <td>public boolean setPromotion(promotionVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理设置促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.getPromotion</th>
          <td>语法</td>
          <td>public list<promotionVO> getPromotion()</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理获取促销策略列表</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.deletePromotion</th>
          <td>语法</td>
          <td>public list<promotionVO> deletePromotion(String promotionID)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理选中要删除的促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.modifyPromotion</th>
          <td>语法</td>
          <td>public boolean modifyPromotion(String promotionID, promotionVO vo)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>总经理更改原来的促销策略</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionBL.getPromotion</th>
          <td>语法</td>
          <td>public List<PromotionPO> getPromotion()</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>获取全部促销策略</td>
        </tr>
        <tr>
            <td colspan="3">需要的服务（需接口）</td>
        </tr>
        <tr>
            <td>服务名</td>
            <td colspan="2">服务</td>
        </tr>
        <tr>
            <td>DatabaseFactory.getPromotionData</td>
            <td colspan="2">得到数据库服务的引用</td>
        </tr>
        <tr>
            <td>PromotionDataService.find(String id)</td>
            <td colspan="2">根据ID查找单一持久化对象</td>
        </tr>
        <tr>
            <td>PromotionDataService.finds(String fields, int value)</td>
            <td colspan="2">根据字段名称和值查找多个持久化对象</td>
        </tr>
        <tr>
            <td>PromotionDataService.insert(PromotionVO vo)</td>
            <td colspan="2">在数据库中插入PromotionVO对象</td>
        </tr>
        <tr>
            <td>PromotionDataService.insert(PromotionVO vo)</td>
            <td colspan="2">插入一个持久化对象</td>
        </tr>
        <tr>
            <td>PromotionDataService.delete(PromotionVO vo)</td>
            <td colspan="2">删除一个持久化对象</td>
        </tr>
        <tr>
            <td>PromotionDataService.update(PromotionVO vo)</td>
            <td colspan="2">更新一个持久化对象</td>
        </tr>
    </table>
</html>

#### 4.2.9.4 业务逻辑层的动态模型

下图表明了灯具销售系统中，当总经理进行促销策略制定时，促销策略制定业务逻辑处理和对象之间的协作

##### 制定促销策略顺序图
![图：制定促销策略顺序图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/制定促销策略顺序图.png)

#### 4.2.9.5 业务逻辑层的设计原理
利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象


### 4.3 数据层的分解

#### 4.3.1  CommodityData模块
##### 4.3.1.1 模块概述
CommodityData模块负责保存商品、商品分类、库存类单据和库存变动记录，进行商品和商品分类的增删改查操作，库存类单据的保存和库存变动记录的查看


##### 4.3.1.2 模块内部类的接口规范
###### CommodityData的接口规范
<html>
    <table>
        <tr>
            <th colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.add</th>
          <td>语法</td>
          <td>public ResultMessage add(goodsPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>增加一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.delete</th>
          <td>语法</td>
          <td>public ResultMessage delete(goodsPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.modify</th>
          <td>语法</td>
          <td>public ResultMessage modify(goodsPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>更新一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.find</th>
          <td>语法</td>
          <td>public ArrayList<GoodsPO> find(String keyword, String type)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>根据关键字返回查找结果</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.newID</th>
          <td>语法</td>
          <td>public int newID(String string)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回下一个id</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Goods.sentAlertMessage</th>
          <td>语法</td>
          <td>void sentAlertMessage(GoodsPO po) throws ClientException</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>发送信息</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Catagory.add</th>
          <td>语法</td>
          <td>public boolean add(catagoryPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>增加一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Catagory.delete</th>
          <td>语法</td>
          <td>public boolean delete(catagoryPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Catagory.modify</th>
          <td>语法</td>
          <td>public boolean modify(catagoryPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.Catagory.find</th>
          <td>语法</td>
          <td>public ArrayList<GoodsPO> find(String keyword, String type)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回查询结果</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.CommdityRecipts.add
          <td>语法</td>
          <td>public ResultMessage add(CommodityReciptPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>新增一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.CommdityRecipts.modify
          <td>语法</td>
          <td>public ResultMessage modify(ArrayList<CommodityReciptPO> list)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.CommdityRecipts.find
          <td>语法</td>
          <td>public ArrayList<CommodityReciptPO> find(String keyword, String type)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回结果</td>
        </tr>
        <tr>
          <th rowspan="3">CommodityData.CommdityRecipts.find
          <td>语法</td>
          <td>public ArrayList<CommodityReciptPO> find(String startTime, String endTime, String customerName, String operator)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回结果</td>
        </tr>
    </table>
</html>

--------------


#### 4.3.4 BankAccountData模块

##### 4.3.4.1 模块概述

BankAccountData模块负责银行账户数据的保存、增、删、改、查服务。

##### 4.3.4.2 模块内部接口规范

<html>
    <table>
        <tr>
            <th colspan="3">提供的服务（供接口）</th>
        </tr>
        <tr>
            <th rowspan="3">BankAccountData.add</th>
            <td>语法</td>
            <td>public ResultMessage add (BankAccountPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中不存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中增加一个po记录</td>
        </tr>
        <tr>
            <th rowspan="3">BankAccountData.delete</th>
            <td>语法</td>
            <td>public ResultMessage delete (String id)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>在数据库中存在该id的po</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中删除这个po</td>
        </tr>
        <tr>
            <th rowspan="3">BankAccountData.modify</th>
            <td>语法</td>
            <td>public ResultMessage modify (BankAccountPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中修改一个po</td>
        </tr>
        <tr>
            <th rowspan="3">BankAccountData.find</th>
            <td>语法</td>
            <td>public BankAccountPO find (String id)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>无</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>按id进行查找返回相应的BankAccountPO结果</td>
        </tr>
    </table>
</html>


--------------


#### 4.3.5 ReciptData模块

##### 4.3.5.1 模块概述

BankAccountData模块负责财务单据数据的保存、增、删、改、查服务。（包括收款单、付款单、现金费用单）

##### 4.3.5.2 模块内部接口规范

<html>
    <table>
        <tr>
            <th colspan="3">提供的服务（供接口）</th>
        </tr>
        <tr>
            <th rowspan="3">ReciptData.addCollectionOrder</th>
            <td>语法</td>
            <td>public ResultMessage addCollectionOrder (CollectionOrderPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中不存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中增加一个po记录</td>
        </tr>
        <tr>
            <th rowspan="3">ReciptData.addPaymentOrder</th>
            <td>语法</td>
            <td>public ResultMessage addPaymentOrder (PaymentPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中不存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中增加一个po记录</td>
        </tr>
        <tr>
            <th rowspan="3">ReciptData.addCashBill</th>
            <td>语法</td>
            <td>public ResultMessage addCashBill (CashBillPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中不存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中增加一个po记录</td>
        </tr>
        <tr>
            <th rowspan="3">ReciptData.getOne</th>
            <td>语法</td>
            <td>public ReciptPO getOne (String id)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>无</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>按id进行查找返回相应的ReciptPO结果</td>
        </tr>
    </table>
</html>


---------------


#### 4.3.6 Account模块

##### 4.3.6.1 模块概述

AccountData模块负责账、期初信息数据的保存、增、查服务。

##### 4.3.6.2 模块内部接口规范

<html>
    <table>
        <tr>
            <th colspan="3">提供的服务（供接口）</th>
        </tr>
        <tr>
            <th rowspan="3">AccountData.get</th>
            <td>语法</td>
            <td>public AccountPO get (String id)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>无</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>按id进行查找返回相应的AccountPO结果</td>
        </tr>
        <tr>
            <th rowspan="3">AccountData.add</th>
            <td>语法</td>
            <td>public ResultMessage add (AccountPO po)</td>
        </tr>
        <tr>
            <td>前置条件</td>
            <td>同样ID的po在数据库中不存在</td>
        </tr>
        <tr>
            <td>后置条件</td>
            <td>在数据库中增加一个po记录</td>
        </tr>
    </table>
</html>


---------------


#### 4.3.1 RecordData模块

##### 4.3.1.1 模块概述

RecordData模块负责保存经营情况表单，总经理和财务人员进行查看操作，系统在每次查看时进行更新操作

##### 4.3.1.2 模块内部接口规范

<html>
    <table>
        <tr>
          <th rowspan="3">RecordDataService.find</th>
          <td>语法</td>
          <td>public RecordPO find(String id) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>按ID进行查找返回相应的RecordPO结果</td>
        </tr>
        <tr>
          <th rowspan="3">RecordDataService.update</th>
          <td>语法</td>
          <td>public boolean update (RecordPO PO) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>在数据库中存在同样ID的RecordPO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>更新一个po</td>
        </tr>
        <tr>
          <th rowspan="3">RecordDataService.init</th>
          <td>语法</td>
          <td>public boolean init() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>初始化持久化数据库</td>
        </tr>
        <tr>
          <th rowspan="3">RecordDataService.finish</th>
          <td>语法</td>
          <td>public boolean finish() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>结束持久化数据库的使用</td>
        </tr>
    </table>
</html>

---------------

#### 4.3.2 PromotionData模块

##### 4.3.2.1 模块概述

PromotionData模块负责保存促销策略，总经理进行增删改查操作

##### 4.3.2.2 模块内部接口规范

<html>
    <table>
        <tr>
          <th rowspan="3">PromotionDataService.find</th>
          <td>语法</td>
          <td>public PromotionPO find(String id) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>按ID进行查找返回相应的PromotionPO结果</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionDataService.insert</th>
          <td>语法</td>
          <td>public boolean insert(PromotionPO po) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>同样ID的PromotionPO在Mapper中不存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>在数据库中增加一个PromotionPO记录</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionDataService.delete</th>
          <td>语法</td>
          <td>public boolean delete(PromotionPO po) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>在数据库中存在同样ID的PromotionPO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个Promotionpo</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionDataService.update</th>
          <td>语法</td>
          <td>public boolean update (PromotionPO PO) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>在数据库中存在同样ID的PromotionPO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>更新一个Promotionpo</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionDataService.init</th>
          <td>语法</td>
          <td>public boolean init() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>初始化持久化数据库</td>
        </tr>
        <tr>
          <th rowspan="3">PromotionDataService.finish</th>
          <td>语法</td>
          <td>public boolean finish() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>结束持久化数据库的使用</td>
        </tr>
    </table>
</html>

---------------

#### 4.3.3 CheckData模块

##### 4.3.3.1 模块概述

CheckData模块负责保存进货销售人员和总经理提交的待审批表单，总经理进行查看、修改操作，财务人员和进货销售人员进行插入、修改操作

##### 4.3.3.2 模块内部接口规范

<html>
    <table>
        <tr>
          <th rowspan="3">CheckDataService.find</th>
          <td>语法</td>
          <td>public CheckPO find(String id) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>按ID进行查找返回相应的CheckPO结果</td>
        </tr>
        <tr>
          <th rowspan="3">CheckDataService.insert</th>
          <td>语法</td>
          <td>public boolean insert(CheckPO po) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>同样ID的CheckPO在Mapper中不存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>在数据库中增加一个CheckPO记录</td>
        </tr>
        <tr>
          <th rowspan="3">CheckDataService.update</th>
          <td>语法</td>
          <td>public boolean update (CheckPO PO) throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>在数据库中存在同样ID的CheckPO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>更新一个po</td>
        </tr>
        <tr>
          <th rowspan="3">CheckDataService.init</th>
          <td>语法</td>
          <td>public boolean init() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>初始化持久化数据库</td>
        </tr>
        <tr>
          <th rowspan="3">CheckDataService.finish</th>
          <td>语法</td>
          <td>public boolean finish() throw RemoteException;</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>无</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>结束持久化数据库的使用</td>
        </tr>
    </table>
</html>


## 5. 依赖视角

### 客户端包图

![图：客户端包图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/依赖视角客户端包图.png)

### 服务器端包图

![图：服务器端包图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/详细设计文档图/依赖视角服务器端包图.png)
